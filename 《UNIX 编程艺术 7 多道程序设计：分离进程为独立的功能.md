Unix 最具特点的程序模块化技法就是将大型程序分解成多个协作进程。

Unix设计风格都运用“做单件事并做好”的方法，强调用定义良好的进程间通信或共享文件来连通小型进程。


● 降低进程生成的开销。
● 提供方法（shellout[shell 执行模块]、I/O 重定向、管道、消息传递和套接字）简化进程间通信
● 提倡使用能由管道和套接字传递的简单、透明的文本数据格式。



## 7.1 从性能调整中分离复杂度控制

在开发出可以把全局复杂度降至最低程度的干净体系之前，关注性能问题便是过早优化——万恶之源（详细讨论参见第12章）。


线程：
一个密切相关的干扰话题是线程（也就是，共用同一存储地址空间的多个并发进程）。
总的来说，线程不是降低而是提高了全局复杂度，因此，除非万不得已，尽量避免使用线程。
>>通常，一个 setuid 程序只在一个或很少几个操作中需要特权。常常可以把这样的程序划分成两个协作进程，小进程需要setuid，大的则不需要。当我们能够这样做时，只须信任较小程序的代码。Unix比竞争对手拥有更好的安全记录，很大一部分就是因为这种划分和委托在Unix中是可行的

## 7.2 Unix IPC 方法的分类

### 7.2.1 把任务转给专门程序
廉价的进程生成使程序间的协作变为可能，其中最简单的形式就是一个程序调用另一个程序来完成专门任务。

### 7.2.2 管道、重定向和过滤器
他发明的管道结构始终闪现在Unix设计中，促进了“做单件事并做好”哲学的萌发

管道 ： |
重定向： > <

人们很容易低估管道和重定向的组合能力
管道的主要缺点是单向性。管道线的成员除了终止外（在这种情况下，前一阶段的程序会在下一个写操作时得到SIGPIPE 信号）不可能回传控制信息。(golang 中管道可以是双向)



### 7.2.3 包装器
包装器或者将被调用程序专用化，或者为它创建新的接口。包装器之所以存在，常常源于要指定参数来修改被调用程序的行为。

### 7.2.4 安全性包装器和Bernstein链


### 7.2.5 从进程
互的主/从通信极为复杂，通常只在这两种条件下使用：（a）两者间涉及的协议完全无足轻重，
（b）从进程是为以我们在第5章讨论的应用协议进行通讯而设计的。

### 7.2.6 对等进程间通信

迄今我们已经讨论的各种通讯方法都存在隐含的层次关系，即一个程序实际上控制或驱动另一个程序，而在反方向却没有或仅有有限的反馈。在通信和网络中，我们常常需要对等的通道，通常（但不一定）需要数据能自由地双向流动。


#### 临时文件
把临时文件作为协作程序之间的通信中转站使用，是最古老的IPC技法.
- 把临时文件作为IPC技法使用最明显的问题是，如果进程在临时文件可被删除前中断，则往往会遗留垃圾数据
- 最后，如果攻击程序知道临时文件将要写入的位置，就可以覆盖掉那个文件，很可能读取生产者进程的数据，或者通过在文件中插入修改或假造的数据哄骗消费者进程[10]
，临时文件仍然还有一席之地；因为它们很容易创建，很灵活，与那些复杂的方法相比，没那么容易产生死锁和竞争
#### 信号
要让同一台机器上的两个进程相互通信，最简单最原始的方法是一个进程向另一个发送信号